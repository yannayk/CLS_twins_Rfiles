"0","## Function of CL measurement and treatment uptake possibilities with GA_subtree included at the end of each branch"
"0","# Output of each branch is a vector of GA category probabilities of length v_GA_cat"
"0","# Output of the function is the combined strategy GA probabilities (all, progesterone only, or cerclage only)"
"0",""
"0","CL_subtree <- function(p_cl25.,                  # 3 variables for the CL detection rates"
"0","                       p_cl15.,"
"0","                       e_cp_28. = rr_cp_28,      # 12 variables for treatment effect "
"0","                       e_cp_32. = rr_cp_32,      # Set at baseline to the treatment effect variables"
"0","                       e_cp_34. = rr_cp_34,"
"0","                       e_cp_37. = rr_cp_37,"
"0","                       e_p_28. = rr_p_28,"
"0","                       e_p_32. = rr_p_32,"
"0","                       e_p_34. = rr_p_34,"
"0","                       e_p_37. = rr_p_37,"
"0","                       e_c_28. = rr_c_28,"
"0","                       e_c_32. = rr_c_32,"
"0","                       e_c_34. = rr_c_34,"
"0","                       e_c_37. = rr_c_37,"
"0","                       p_prog. = p_prog,        # 3 variables for progesterone and cerclage utilization rates"
"0","                       p_pY_cerc. = p_pY_cerc,"
"0","                       p_pN_cerc. = p_pN_cerc,"
"0","                       p_cl15_28.,              # 8 variables for delivery GA probabilities (t1 vs. t2)"
"0","                       p_cl15_32.,"
"0","                       p_cl15_34.,"
"0","                       p_cl15_37.,"
"0","                       p_cl25_28.,              "
"0","                       p_cl25_32.,"
"0","                       p_cl25_34.,"
"0","                       p_cl25_37.,"
"0","                       GA_sub. ) {              # 11th subtree without default end prob (will include this function)"
"0","  "
"0","  # Tree read top to bottom arbitrarily"
"0","  "
"0","  # 1. CL <= 25, CL <= 15, Prog YES, Cerc YES"
"0","  a <- p_cl25. * p_cl15. * p_prog. * p_pY_cerc. * GA_subtree(e_28. = e_cp_28.,"
"0","                                                             e_32. = e_cp_32.,"
"0","                                                             e_34. = e_cp_34.,"
"0","                                                             e_37. = e_cp_37., "
"0","                                                             p_28. = p_cl15_28.,"
"0","                                                             p_32. = p_cl15_32.,"
"0","                                                             p_34. = p_cl15_34.,"
"0","                                                             p_37. = p_cl15_37.)"
"0","  "
"0","  # 2. CL <= 25, CL <= 15, Prog YES, Cerc NO"
"0","  b <- p_cl25. * p_cl15. * p_prog. * (1 - p_pY_cerc.) * GA_subtree(e_28. = e_p_28.,"
"0","                                                                   e_32. = e_p_32.,"
"0","                                                                   e_34. = e_p_34.,"
"0","                                                                   e_37. = e_p_37., "
"0","                                                                   p_28. = p_cl15_28.,"
"0","                                                                   p_32. = p_cl15_32.,"
"0","                                                                   p_34. = p_cl15_34.,"
"0","                                                                   p_37. = p_cl15_37.)"
"0","  "
"0","  # 3. CL <= 25, CL <= 15, Prog NO, Cerc YES"
"0","  c <- p_cl25. * p_cl15. * (1 - p_prog.) * p_pN_cerc. * GA_subtree(e_28. = e_c_28.,"
"0","                                                                   e_32. = e_c_32.,"
"0","                                                                   e_34. = e_c_34.,"
"0","                                                                   e_37. = e_c_37., "
"0","                                                                   p_28. = p_cl15_28.,"
"0","                                                                   p_32. = p_cl15_32.,"
"0","                                                                   p_34. = p_cl15_34.,"
"0","                                                                   p_37. = p_cl15_37.)"
"0","  "
"0","  # 4. CL <= 25, CL <= 15, Prog NO, Cerc NO (no treatment)"
"0","  d <- p_cl25. * p_cl15. * (1 - p_prog.) * (1 - p_pN_cerc.) * GA_subtree(p_28. = p_cl15_28.,"
"0","                                                                         p_32. = p_cl15_32.,"
"0","                                                                         p_34. = p_cl15_34.,"
"0","                                                                         p_37. = p_cl15_37.)"
"0","  "
"0","  # 5. CL <= 25, CL > 15, Prog YES"
"0","  e <- p_cl25. * (1 - p_cl15.) * p_prog. * GA_subtree(e_28. = e_p_28.,"
"0","                                                      e_32. = e_p_32.,"
"0","                                                      e_34. = e_p_34.,"
"0","                                                      e_37. = e_p_37., "
"0","                                                      p_28. = p_cl25_28.,"
"0","                                                      p_32. = p_cl25_32.,"
"0","                                                      p_34. = p_cl25_34.,"
"0","                                                      p_37. = p_cl25_37.)"
"0","  "
"0","  # 6. CL <= 25, CL > 15, Prog NO (no treatment)"
"0","  f <- p_cl25. * (1 - p_cl15.) * (1 - p_prog.) * GA_subtree(p_28. = p_cl25_28.,"
"0","                                                            p_32. = p_cl25_32.,"
"0","                                                            p_34. = p_cl25_34.,"
"0","                                                            p_37. = p_cl25_37.)"
"0","  "
"0","  # 7. WHEN t1 --> CL > 25 (no treatment), WHEN t2 --> 1-7 above"
"0","  g <- (1 - p_cl25.) * GA_sub. "
"0","  "
"0","  # For all strategies, this branch will end with the CL_subtree function"
"0","  # The sub-function branch 7 will end with GA_subtree (no treatment)"
"0","  "
"0","  # Add the proportions from each branch to produce the overall bins for the given strategy"
"0","  all    <- a + b + c + d + e + f + g  # All 7 branches"
"0","  prog   <- a + b + e                  # Progesterone treated branches (GA distributions needed for costs)"
"0","  cerc   <- sum(a + c)                 # Cerclage treatment branches (GA distributions not needed for costs) "
"0","  vscx   <- sum(a + b + c + d)         # Proportion with very short cervix (<= 15 mm)"
"0","  scx    <- sum(e + f)"
"0","  "
"0","  return(list(all = all, "
"0","              p = prog, "
"0","              c = cerc,"
"0","              vscx = vscx,"
"0","              scx = scx))"
"0","}"
