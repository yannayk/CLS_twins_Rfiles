"0","## COSTS ##"
"0",""
"0","## Function to calculate total costs for a given gestational age category"
"0",""
"0","markov_costs <- function(m_M.,"
"0","                         v_c_A.,"
"0","                         n_cycles. = n_cycles,"
"0","                         cycle_length. = cycle_length,"
"0","                         n_states. = n_states,"
"0","                         v_names_states. = v_names_states,"
"0","                         d_c. = d_c,"
"0","                         c_D. = c_D) {"
"0","  "
"0","  # Initiate an empty matrix for costs"
"0","  m_ann_cost <- matrix(NA,"
"0","                       nrow = (n_cycles. + 1), ncol = n_states.,"
"0","                       dimnames = list(0: n_cycles., v_names_states.))"
"0","  "
"0","  # Populate the matrix with state costs"
"0","  m_ann_cost[, 1] <- v_c_A."
"0","  m_ann_cost[, 2] <- c_D."
"0","  "
"0","  ## Annual discount weights for costs"
"0","  v_dwc <- 1 / (( 1 + (d_c. * cycle_length.)) ^ (0 : n_cycles.))"
"0","  "
"0","  # Initiate an empty matrix for costs"
"0","  m_c_GA <- matrix(NA,"
"0","                   nrow = (n_cycles. + 1), ncol = 1,"
"0","                   dimnames = list(0: n_cycles., ""Cost""))"
"0","  "
"0","  # Populate the single column matrix (state * state_cost)"
"0","  for (t in 0: n_cycles. + 1){"
"0","    m_c_GA[t, ] <- m_M.[t, ] %*% m_ann_cost[t, ]"
"0","  }"
"0","  "
"0","  # Discount and sum the costs to give the GA category total"
"0","  c_GA <- sum(m_c_GA * v_dwc)"
"0","  "
"0","  return(list(annual = m_ann_cost,   # Annual costs by state for GA category"
"0","              total  = c_GA,         # Total costs for GA category"
"0","              disc   = v_dwc))       # Annual discount rate (not GA specific)"
"0","}"
"0",""
"0","# Calculation of total cost in markov chain by GA"
"0","c_M_28   <- markov_costs(m_M. = m_M_28, v_c_A. = v_c_28)$total"
"0","c_M_32   <- markov_costs(m_M. = m_M_32, v_c_A. = v_c_32)$total"
"0","c_M_34   <- markov_costs(m_M. = m_M_34, v_c_A. = v_c_34)$total"
"0","c_M_37   <- markov_costs(m_M. = m_M_37, v_c_A. = v_c_37)$total"
"0","c_M_term <- markov_costs(m_M. = m_M_term, v_c_A. = v_c_term)$total"
"0",""
"0","# Vector of costs by GA"
"0","v_c_M_GA <- c(c_M_28, c_M_32, c_M_34, c_M_37, c_M_term)"
"0",""
"0","## STRATEGY TOTALS - COSTS ##"
"0",""
"0","# Product of costs by GA * GA distribution for a strategy"
"0","c_s1 <- sum(v_c_M_GA * s1_GA)"
"0","c_s2 <- sum(v_c_M_GA * s2_GA)"
"0","c_s3 <- sum(v_c_M_GA * s3_GA)"
"0",""
"0","# Vector of strategy costs"
"0","v_M_costs <- c(s1 = c_s1, s2 = c_s2, s3 = c_s3)"
