"0","## Function that calculates the gestational age subtree"
"0","# Tree read top to bottom, arbitrarily "
"0","# Output: vector with length of v_GA_cat that contains probabilities of each GA category"
"0",""
"0","GA_subtree <- function(e_28. = 1, # 4 variables for the effectiveness of treatment for given GA category"
"0","                       e_32. = 1,"
"0","                       e_34. = 1,"
"0","                       e_37. = 1,"
"0","                       p_28.,     # 4 variables for the probability of delivery at GA category"
"0","                       p_32.,"
"0","                       p_34.,"
"0","                       p_37.) {"
"0","  "
"0","  # Calculates the probability of ending up in a GA category"
"0","  a <-      (e_28. * p_28.)                                                                           # < 28 wks"
"0","  b <- (1 - (e_28. * p_28.)) *      (e_32. * p_32.)                                                   # 28-32 wks"
"0","  c <- (1 - (e_28. * p_28.)) * (1 - (e_32. * p_32.)) *      (e_34. * p_34.)                           # 32-34 wks"
"0","  d <- (1 - (e_28. * p_28.)) * (1 - (e_32. * p_32.)) * (1 - (e_34. * p_34.)) *      (e_37. * p_37.)   # 34-37 wks"
"0","  e <- (1 - (e_28. * p_28.)) * (1 - (e_32. * p_32.)) * (1 - (e_34. * p_34.)) * (1 - (e_37. * p_37.))  # >= 37 wks (term)"
"0","  "
"0","  # Vector of probabilities for each GA category "
"0","  all_cat <- c(""<28""   = a,"
"0","               ""28-32"" = b, "
"0","               ""32-34"" = c,"
"0","               ""34-37"" = d,"
"0","               "">37""   = e)"
"0","  "
"0","  return(all_cat)"
"0","}"
